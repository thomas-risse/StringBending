% !TeX spellcheck = en_US
\documentclass[9pt]{scrartcl}
\usepackage{graphicx}
\usepackage[a4paper,left=3cm,right=2cm,top=2.5cm,bottom=2.5cm]{geometry}

\usepackage{amsmath, amsfonts,amssymb,amsthm, bm}
\usepackage{amsfonts}
\usepackage[backend=biber,style=numeric]{biblatex}
\addbibresource{biblio.bib}

\usepackage{tabstackengine}
\setstacktabbedgap{1.5\baselineskip}
\setstackgap{L}{1.5\baselineskip}

\newcommand{\vect}[1]{\mathbf {#1}}
\newcommand{\mat}[1]{\mathbf {#1}}

\newcommand{\matO}{\mat 0}

\usepackage{xcolor}


\title{Nonlinear string bending using SAV}

\author{Thomas Risse}


\begin{document}
	\maketitle
	
  \section{Introduction}

  With recent advances, SAV schemes for distributed nonlinear systems with up to a few hundreds of degrees of freedom allow for real-time simulations. Specifically, the auxiliary variable drift issue can now be mitigated using several methods from the literature, including the control method that we proposed in DAFX2025. While strong convergence results for arbitrary nonlinear systems are still out of reach, current real-time implementations of isolated systems such as strings open new sound design opportunities. 

  This work aims at extending these new opportunities by \emph{bending} the underlying physical models to both produce new sounds and facilitate the synthesis control.
  The main idea exploits the clear separation of the linear and nonlinear parts of a system arising when applying the SAV transform. This separation appears both in the dynamical equations and in the corresponding energy function, ensuring a global energy stability. Then, one can tune the linear and nonlinear parts independently physical considerations, but still ensuring  preservation in both the continuous and discrete time domains. 

  Major steps:
  \begin{enumerate}
    \item First, the considered system category is presented. In order to facilitate the control of the linear behavior, a "modal" representation is used.
    \item Recall of the time-stepping scheme. The popular interleaved SAV scheme is used, with the addition of the drift mitigating method.
    \item A physical inspiration as a base model: the nonlinear string.
    \item First bending method: modification of the linear characteristics of the system, keeping the nonlinear law unchanged.
    \item Second bending method: nonlinear energy shaping, aiming at e.g. softening non-linearities (expected problem with lower bound) or specific mode coupling.
    \item Handling of parameter modulations.
  \end{enumerate}

  \section{System(s) description}

  The following category of system (usually obtained from quadratisation) is considered:
  \begin{subequations}
  \begin{equation}
    \begin{bmatrix}
      \dot{\mat p} \\
      \dot{\mat q} \\
      \dot r
    \end{bmatrix}
    =
    \left(
    \begin{bmatrix}
      \matO & -\mat I & - \mat g(\mat q) \\
      \mat I & \matO & \matO \\
      \mat g(\mat q) & \matO & \mat 0 
    \end{bmatrix}
    -
    \begin{bmatrix}
      \mat R (\mat q) & \matO & \matO \\
      \matO & \matO & \matO \\
      \matO & \matO & \matO
    \end{bmatrix}
    \right)
    \begin{bmatrix}
      \mat M^{-1} \mat p \\
      \mat K \mat q \\
      r
    \end{bmatrix}
    + \mat G_p \mat u,
  \end{equation}
  \end{subequations}
  with $ \mat p$ and $\mat q$ the modal coordinates, $r$ the auxiliary variable and diagonal modal matrices $\mat M$, $\mat K$ and $\mat R$. $\mat g(\mat q)$ is computed as 
  \begin{equation}
    \mat g(\mat q) = \frac{\mat J_0 \mat f_{nl}(\mat q)}{\sqrt{2 E_{\mathrm nl} (\mat q) + C_0}} 
    - \lambda_0 \epsilon(\mat q, r) \frac{\mathrm{sign}(\mat M^{-1} \mat p) }{\vert\vert \mat M^{-1} \mat p\vert\vert_{L^1}}
  \end{equation}
	with $E_{\mathrm nl} \mat q: \mathbb R^N \mapsto \mathbb R$ an arbitrary lower bounded nonlinear function corresponding to an energy with associated nonlinear force $\mat f_{\mathrm nl} (\mat q) = \nabla E_{\mathrm nl}$. Note that $\mat g$ includes the control term proposed in the dafx paper, with $\epsilon (\mat q, r) = r - \sqrt{2 E_{\mathrm nl} (\mat q) + C_0}$.

  The system has Hamiltonian
  \begin{equation}
     H(\mat p, \mat q, r) = \frac{1}{2} \left(\mat p^\intercal \mat M^{-1} \mat p + \mat q^\intercal \mat K \mat q + r^2\right).
  \end{equation}
  In prevision of the user interface, it is useful to rewrite the system matrices from the modal amplitudes $\mat A$, characteristic pulsations $\boldsymbol{\Omega}$ and decay times $\mat T$ (themselves related to the quality factors as $\mat T = \frac{2 \mat Q}{6.9 \boldsymbol{\Omega}}$), yielding:
  \begin{align}
    \mat M& = \mat A, \\
    \mat K& = \mat A \boldsymbol{\Omega}^2,\\
    \mat R& = \frac{2 * 6.9}{\mat T} \mat A.
  \end{align}

  The definition of both the nonlinear function $E_{\mathrm{nl}}$ and input matrix $\mat G_p$ are left for step 3.

  \section{Time-stepping scheme}

  Same than DAFX2025.

  \section{Starting point: cubic nonlinear string model}

  \section{Bending the linear part}

  \section{Energy shaping}

  \section{Modulations}
\end{document}